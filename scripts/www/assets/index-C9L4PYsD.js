var Y=Object.defineProperty;var Z=(s,r,t)=>r in s?Y(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t;var I=(s,r,t)=>Z(s,typeof r!="symbol"?r+"":r,t);import{u as K,r as u,j as e,C as J,O as Q,a as ee,b as te,H as W,R as $,c as re}from"./three-ZhSZsvMD.js";import{c as se,P as ae,a as ne,C as S,X as E,A as O,b as T,d as le,e as z,S as ie,G as oe,R as ce,f as de,g as ue,h as xe,i as ge,M as me,j as he,k as be}from"./vendor-Dezasnlk.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();const pe=s=>(r,t,l)=>{const n=l.subscribe;return l.subscribe=(d,o,x)=>{let b=d;if(o){const h=(x==null?void 0:x.equalityFn)||Object.is;let g=d(l.getState());b=p=>{const j=d(p);if(!h(g,j)){const y=g;o(g=j,y)}},x!=null&&x.fireImmediately&&o(g,g)}return n(b)},s(r,t,l)},fe=pe,k={structure:[{id:"left_front_longitudinal",name:"å·¦å‰çºµæ¢",category:"structure"},{id:"right_front_longitudinal",name:"å³å‰çºµæ¢",category:"structure"},{id:"left_front_shock",name:"å·¦å‰æ‚¬æŒ‚å‡éœ‡å™¨",category:"structure"},{id:"right_front_shock",name:"å³å‰æ‚¬æŒ‚å‡éœ‡å™¨",category:"structure"},{id:"left_rear_shock",name:"å·¦åŽæ‚¬æŒ‚å‡éœ‡å™¨",category:"structure"},{id:"right_rear_shock",name:"å³åŽæ‚¬æŒ‚å‡éœ‡å™¨",category:"structure"}],paint:[{id:"left_a_pillar_paint",name:"å·¦AæŸ±æ¼†é¢",category:"paint",parent:"left_a_pillar"},{id:"left_a_pillar_weld",name:"å·¦AæŸ±ç„Šç‚¹èƒ¶æ¡",category:"paint",parent:"left_a_pillar"},{id:"right_a_pillar_paint",name:"å³AæŸ±æ¼†é¢",category:"paint",parent:"right_a_pillar"},{id:"right_a_pillar_weld",name:"å³AæŸ±ç„Šç‚¹èƒ¶æ¡",category:"paint",parent:"right_a_pillar"},{id:"left_b_pillar_paint",name:"å·¦BæŸ±æ¼†é¢",category:"paint",parent:"left_b_pillar"},{id:"left_b_pillar_weld",name:"å·¦BæŸ±ç„Šç‚¹èƒ¶æ¡",category:"paint",parent:"left_b_pillar"},{id:"right_b_pillar_paint",name:"å³BæŸ±æ¼†é¢",category:"paint",parent:"right_b_pillar"},{id:"right_b_pillar_weld",name:"å³BæŸ±ç„Šç‚¹èƒ¶æ¡",category:"paint",parent:"right_b_pillar"},{id:"left_c_pillar_paint",name:"å·¦CæŸ±æ¼†é¢",category:"paint",parent:"left_c_pillar"},{id:"left_c_pillar_weld",name:"å·¦CæŸ±ç„Šç‚¹èƒ¶æ¡",category:"paint",parent:"left_c_pillar"},{id:"right_c_pillar_paint",name:"å³CæŸ±æ¼†é¢",category:"paint",parent:"right_c_pillar"},{id:"right_c_pillar_weld",name:"å³CæŸ±ç„Šç‚¹èƒ¶æ¡",category:"paint",parent:"right_c_pillar"}]},i={UNCHECKED:"unchecked",NORMAL:"normal",WARNING:"warning",ERROR:"error"},L=new Set(Object.values(i)),M=s=>{if(!s||typeof s!="object")return{};const r=["__proto__","constructor","prototype"];return Object.fromEntries(Object.entries(s).filter(([t])=>!r.includes(t)))},A=s=>!s||typeof s!="string"?!1:[...k.structure,...k.paint].some(t=>t.id===s),m=se(fe((s,r)=>({currentType:"structure",selectedPoint:null,results:{},setCurrentType:t=>{if(!["structure","paint"].includes(t)){console.warn(`Invalid inspection type: ${t}`);return}s({currentType:t,selectedPoint:null})},selectPoint:t=>{if(t&&!A(t)){console.warn(`Invalid point ID: ${t}`);return}s({selectedPoint:t})},setResult:(t,l,n={})=>{if(!t){console.error("setResult: pointId is required");return}if(!A(t)){console.error(`setResult: Invalid point ID: ${t}`);return}if(!L.has(l)){console.error(`setResult: Invalid status: ${l}`);return}const a=M(n);let d={...a};if(a.paintThickness!==void 0){const o=parseInt(a.paintThickness,10);isNaN(o)||o<0||o>3e3?(console.warn(`Invalid paint thickness: ${a.paintThickness}`),d.paintThickness=void 0):d.paintThickness=o}a.note&&(d.note=String(a.note).trim().slice(0,500)),s(o=>({results:{...o.results,[t]:{status:l,timestamp:new Date().toISOString(),...d}}}))},getPointStatus:t=>{if(!t)return i.UNCHECKED;const l=r().results[t];return(l==null?void 0:l.status)||i.UNCHECKED},getStats:()=>{const{currentType:t,results:l}=r(),n=k[t];if(!n)return{total:0,checked:0,normal:0,warning:0,error:0,unchecked:0};const a={total:n.length,checked:0,normal:0,warning:0,error:0,unchecked:0};return n.forEach(d=>{var x;const o=((x=l[d.id])==null?void 0:x.status)||i.UNCHECKED;o!==i.UNCHECKED&&a.checked++,a[o]!==void 0&&a[o]++}),a},getPointResult:t=>t&&r().results[t]||null,resetResults:()=>s({results:{},selectedPoint:null}),exportData:()=>({timestamp:new Date().toISOString(),results:r().results,stats:r().getStats()}),importData:t=>{if(!t||typeof t!="object")return console.error("importData: Invalid data format"),!1;if(t.results&&typeof t.results=="object"){const l={};return Object.entries(t.results).forEach(([n,a])=>{A(n)&&L.has(a.status)&&(l[n]={status:a.status,timestamp:a.timestamp||new Date().toISOString(),...M(a)})}),s({results:l}),!0}return!1}}))),_={UNCHECKED:"unchecked",WARNING:"warning",ERROR:"error"},ye=[{id:"left_front_longitudinal",name:"å·¦å‰çºµæ¢",pos:[-1.5,.5,2]},{id:"right_front_longitudinal",name:"å³å‰çºµæ¢",pos:[1.5,.5,2]},{id:"left_front_shock",name:"å·¦å‰æ‚¬æŒ‚",pos:[-1.2,.3,1.5]},{id:"right_front_shock",name:"å³å‰æ‚¬æŒ‚",pos:[1.2,.3,1.5]},{id:"left_rear_shock",name:"å·¦åŽæ‚¬æŒ‚",pos:[-1.2,.3,-1.5]},{id:"right_rear_shock",name:"å³åŽæ‚¬æŒ‚",pos:[1.2,.3,-1.5]}],je=[{id:"left_a_pillar_paint",name:"å·¦AæŸ±æ¼†é¢",pos:[-.9,1.2,.8]},{id:"left_a_pillar_weld",name:"å·¦AæŸ±ç„Šç‚¹",pos:[-.85,1,.8]},{id:"right_a_pillar_paint",name:"å³AæŸ±æ¼†é¢",pos:[.9,1.2,.8]},{id:"right_a_pillar_weld",name:"å³AæŸ±ç„Šç‚¹",pos:[.85,1,.8]},{id:"left_b_pillar_paint",name:"å·¦BæŸ±æ¼†é¢",pos:[-.9,1.2,-.3]},{id:"left_b_pillar_weld",name:"å·¦BæŸ±ç„Šç‚¹",pos:[-.85,1,-.3]},{id:"right_b_pillar_paint",name:"å³BæŸ±æ¼†é¢",pos:[.9,1.2,-.3]},{id:"right_b_pillar_weld",name:"å³BæŸ±ç„Šç‚¹",pos:[.85,1,-.3]},{id:"left_c_pillar_paint",name:"å·¦CæŸ±æ¼†é¢",pos:[-.85,1.3,-1.2]},{id:"left_c_pillar_weld",name:"å·¦CæŸ±ç„Šç‚¹",pos:[-.8,1.1,-1.2]},{id:"right_c_pillar_paint",name:"å³CæŸ±æ¼†é¢",pos:[.85,1.3,-1.2]},{id:"right_c_pillar_weld",name:"å³CæŸ±ç„Šç‚¹",pos:[.8,1.1,-1.2]}];function Ne(){const{progress:s}=te();return e.jsx(W,{center:!0,children:e.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-sm text-white p-5 rounded-xl text-center border border-gray-700 shadow-2xl max-w-[80vw]",children:[e.jsx("div",{className:"text-base font-bold mb-3",children:"åŠ è½½æ¨¡åž‹ä¸­..."}),e.jsx("div",{className:"w-48 h-2 bg-gray-800 rounded-full overflow-hidden mx-auto",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-cyan-400 transition-all duration-300",style:{width:`${s}%`}})}),e.jsxs("div",{className:"mt-2 text-xs text-gray-400",children:[Math.round(s),"%"]})]})})}function ve({name:s,status:r,onClick:t}){const l=r===_.ERROR,n=r===_.WARNING;return!l&&!n?null:e.jsx(W,{distanceFactor:10,children:e.jsx("div",{onClick:a=>{a.stopPropagation(),t==null||t()},className:`
          px-2 py-1 rounded text-xs font-bold whitespace-nowrap cursor-pointer
          shadow-lg border border-white/20 select-none
          active:scale-95 transition-transform
          ${l?"bg-red-500 text-white":"bg-yellow-500 text-black"}
        `,style:{touchAction:"manipulation"},children:s})})}function we({autoRotate:s,onPointClick:r}){const t=u.useRef(),l=m(o=>o.results),{scene:n}=K("/models/2019_volkswagen_jetta.glb");ee((o,x)=>{t.current&&s&&(t.current.rotation.y+=x*.5)});const a=o=>{var x;return((x=l[o])==null?void 0:x.status)||_.UNCHECKED},d=[...ye,...je];return e.jsxs("group",{ref:t,children:[e.jsx("primitive",{object:n,scale:1,position:[0,0,0]}),d.map(o=>{const x=a(o.id);return x===_.WARNING||x===_.ERROR?e.jsx("group",{position:o.pos,children:e.jsx(ve,{name:o.name,status:x,onClick:()=>r==null?void 0:r(o.id)})},o.id):null})]})}function _e({autoRotate:s,onPointClick:r}){const t=u.useRef();return u.useEffect(()=>{const l="ontouchstart"in window||navigator.maxTouchPoints>0;t.current&&l&&(t.current.touchAction="none")},[]),e.jsxs(e.Fragment,{children:[e.jsx("ambientLight",{intensity:.6}),e.jsx("directionalLight",{position:[10,10,5],intensity:1}),e.jsx("directionalLight",{position:[-10,-10,-5],intensity:.5}),e.jsx(Q,{ref:t,enablePan:!0,enableZoom:!0,enableRotate:!0,minDistance:3,maxDistance:15,enableDamping:!0,dampingFactor:.05}),e.jsx("gridHelper",{args:[20,20,"#333","#222"]}),e.jsx(u.Suspense,{fallback:e.jsx(Ne,{}),children:e.jsx(we,{autoRotate:s,onPointClick:r})})]})}function C({color:s,label:r}){return e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:s}}),e.jsx("span",{className:"text-[10px] text-gray-400",children:r})]})}function Ce({onPointClick:s}){const[r,t]=u.useState(!1),l=m(d=>d.currentType),[n,a]=u.useState(!1);return u.useEffect(()=>{a("ontouchstart"in window||navigator.maxTouchPoints>0)},[]),e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx(J,{camera:{position:[5,5,5],fov:50},className:"w-full h-full block outline-none touch-none",gl:{antialias:!0,alpha:!1},children:e.jsx(_e,{autoRotate:r,onPointClick:s})}),e.jsx("button",{onClick:()=>t(!r),className:`
          absolute bottom-4 right-4 z-50 rounded-full 
          flex items-center justify-center
          transition-all duration-200 active:scale-95
          border shadow-lg
          ${n?"w-12 h-12":"w-10 h-10"}
          ${r?"bg-blue-600 border-blue-500":"bg-gray-800/90 border-gray-600"}
        `,style:{touchAction:"manipulation"},title:r?"åœæ­¢æ—‹è½¬":"å¼€å§‹æ—‹è½¬",children:r?e.jsx(ae,{className:`${n?"w-5 h-5":"w-4 h-4"} text-white`}):e.jsx(ne,{className:`${n?"w-5 h-5":"w-4 h-4"} text-white ml-0.5`})}),e.jsx("div",{className:"absolute top-3 left-3 lg:top-4 lg:left-4 z-50 bg-gray-900/90 backdrop-blur-sm px-2.5 py-2 lg:px-3 lg:py-2 rounded-lg border border-gray-700 shadow-lg",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx(C,{color:"#22c55e",label:"æ­£å¸¸"}),e.jsx(C,{color:"#eab308",label:"å¼‚å¸¸"}),e.jsx(C,{color:"#ef4444",label:"ä¸¥é‡"}),e.jsx(C,{color:"#9ca3af",label:"æœªæ£€"})]})}),e.jsx("div",{className:"absolute top-3 right-3 lg:top-4 lg:right-4 z-50 bg-gray-900/90 backdrop-blur-sm px-2.5 py-1.5 lg:px-3 rounded-lg border border-gray-700 shadow-lg",children:e.jsx("span",{className:"text-[10px] lg:text-xs text-gray-400",children:l==="structure"?"è½¦èº«ç»“æž„æ£€æµ‹":"è½¦èº«æ¼†é¢æ£€æµ‹"})}),n&&e.jsx("div",{className:"absolute bottom-16 left-4 right-4 lg:hidden z-40 pointer-events-none",children:e.jsx("div",{className:"bg-gray-900/80 backdrop-blur-sm px-3 py-2 rounded-lg border border-gray-700 text-center",children:e.jsx("p",{className:"text-[10px] text-gray-400",children:"ðŸ‘† å•æŒ‡æ—‹è½¬ Â· ðŸ¤ åŒæŒ‡ç¼©æ”¾"})})})]})}K.preload("/models/2019_volkswagen_jetta.glb");const B={[i.NORMAL]:{bg:"bg-green-500",hover:"hover:bg-green-600",text:"text-green-400",bgOpacity:"bg-green-500/10",border:"border-green-500/30",ring:"ring-green-500/50"},[i.WARNING]:{bg:"bg-yellow-500",hover:"hover:bg-yellow-600",text:"text-yellow-400",bgOpacity:"bg-yellow-500/10",border:"border-yellow-500/30",ring:"ring-yellow-500/50"},[i.ERROR]:{bg:"bg-red-500",hover:"hover:bg-red-600",text:"text-red-400",bgOpacity:"bg-red-500/10",border:"border-red-500/30",ring:"ring-red-500/50"},[i.UNCHECKED]:{bg:"bg-gray-500",hover:"hover:bg-gray-600",text:"text-gray-400",bgOpacity:"bg-gray-500/10",border:"border-gray-500/30",ring:"ring-gray-500/50"}},Re={[i.NORMAL]:"æ­£å¸¸",[i.WARNING]:"å¼‚å¸¸",[i.ERROR]:"ä¸¥é‡",[i.UNCHECKED]:"æœªæ£€"},ke={[i.NORMAL]:T,[i.WARNING]:O,[i.ERROR]:E,[i.UNCHECKED]:S},w=u.memo(({status:s,active:r,onClick:t,label:l,icon:n})=>{const a=B[s];return e.jsxs("button",{onClick:t,className:`
        flex flex-col items-center justify-center p-2.5 rounded-lg
        transition-all duration-200 ease-out border
        ${r?`${a.bg} border-transparent text-white shadow-lg`:`${a.bgOpacity} ${a.border} ${a.text} hover:bg-opacity-20`}
        ${r?`ring-2 ${a.ring} ring-offset-2 ring-offset-gray-900`:""}
      `,children:[e.jsx(n,{className:"w-4 h-4 mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:l})]})});w.displayName="StatusButton";const G=u.memo(({point:s,status:r,isSelected:t,onClick:l,hasPaintData:n,result:a})=>{const d=ke[r],o=B[r];return e.jsxs("div",{onClick:l,className:`
        group flex items-center justify-between p-2.5 rounded-lg cursor-pointer
        transition-all duration-200 border
        ${t?"bg-blue-500/10 border-blue-500/50":"bg-gray-900/30 border-gray-800 hover:border-gray-700 hover:bg-gray-800/30"}
      `,children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(d,{className:`w-4 h-4 ${o.text}`}),e.jsxs("div",{children:[e.jsx("span",{className:`text-sm font-medium ${t?"text-blue-400":"text-gray-300"}`,children:s.name}),(a==null?void 0:a.paintThickness)&&e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:[a.paintThickness,"Î¼m"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`
          text-[10px] px-1.5 py-0.5 rounded border
          ${o.bgOpacity} ${o.text} ${o.border}
        `,children:Re[r]}),e.jsx(le,{className:"w-4 h-4 text-gray-600 group-hover:text-gray-400 transition-colors"})]})]})});G.displayName="PointItem";const R=u.memo(({label:s,value:r,colorClass:t})=>e.jsxs("div",{className:"bg-gray-900/30 rounded-lg p-2.5 border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 mb-0.5 uppercase tracking-wider",children:s}),e.jsx("p",{className:`text-lg font-bold ${t}`,children:r})]}));R.displayName="StatCard";const q=u.memo(({point:s,result:r,onSave:t,onCancel:l})=>{const[n,a]=u.useState((r==null?void 0:r.status)||i.NORMAL),[d,o]=u.useState((r==null?void 0:r.paintThickness)||""),[x,b]=u.useState((r==null?void 0:r.note)||""),[h,g]=u.useState(null),p=s.category==="paint",j=u.useCallback(()=>{if(p&&d!==""){const v=parseInt(d,10);if(isNaN(v)||v<0||v>3e3){g("æ¼†é¢åŽšåº¦å¿…é¡»åœ¨ 0-3000Î¼m ä¹‹é—´");return}}const f={status:n,note:x.trim()};p&&d!==""&&(f.paintThickness=parseInt(d,10)),t(s.id,n,f)},[s.id,s.category,n,d,x,t,p]),y=u.useCallback(f=>{a(f),g(null)},[]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between pb-3 border-b border-gray-800",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-200",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:p?"è½¦èº«æ¼†é¢æ£€æµ‹":"è½¦èº«ç»“æž„æ£€æµ‹"})]}),e.jsx("button",{onClick:l,className:"p-1.5 hover:bg-gray-800 rounded-lg transition-colors border border-gray-800",children:e.jsx(z,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-2 uppercase tracking-wider",children:"æ£€æµ‹çŠ¶æ€"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsx(w,{status:i.NORMAL,active:n===i.NORMAL,onClick:()=>y(i.NORMAL),label:"æ­£å¸¸",icon:T}),e.jsx(w,{status:i.WARNING,active:n===i.WARNING,onClick:()=>y(i.WARNING),label:"å¼‚å¸¸",icon:O}),e.jsx(w,{status:i.ERROR,active:n===i.ERROR,onClick:()=>y(i.ERROR),label:"ä¸¥é‡",icon:E}),e.jsx(w,{status:i.UNCHECKED,active:n===i.UNCHECKED,onClick:()=>y(i.UNCHECKED),label:"æœªæ£€",icon:S})]})]}),p&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1.5 uppercase tracking-wider",children:"æ¼†é¢åŽšåº¦ (Î¼m)"}),e.jsx("input",{type:"number",min:"0",max:"3000",value:d,onChange:f=>{o(f.target.value),g(null)},placeholder:"è¯·è¾“å…¥æ¼†é¢åŽšåº¦",className:`w-full px-3 py-2 bg-gray-900 border border-gray-800 rounded-lg\r
              focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 \r
              outline-none transition-all text-sm text-gray-200 placeholder-gray-600`}),e.jsx("p",{className:"mt-1 text-[10px] text-gray-600",children:"æ­£å¸¸èŒƒå›´ï¼š80-150Î¼m"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1.5 uppercase tracking-wider",children:"å¤‡æ³¨è¯´æ˜Ž"}),e.jsx("textarea",{value:x,onChange:f=>b(f.target.value),placeholder:"è¯·è¾“å…¥æ£€æµ‹å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰",maxLength:500,rows:3,className:`w-full px-3 py-2 bg-gray-900 border border-gray-800 rounded-lg\r
            focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 \r
            outline-none transition-all resize-none text-sm text-gray-200 placeholder-gray-600`}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("p",{className:"text-[10px] text-gray-600",children:"æœ€å¤š 500 å­—ç¬¦"}),e.jsxs("p",{className:`text-[10px] ${x.length>=500?"text-red-400":"text-gray-600"}`,children:[x.length,"/500"]})]})]}),h&&e.jsx("div",{className:"p-2.5 bg-red-500/10 border border-red-500/30 rounded-lg",children:e.jsx("p",{className:"text-xs text-red-400",children:h})}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-gray-800",children:[e.jsxs("button",{onClick:j,className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2 \r
            bg-blue-600 hover:bg-blue-500 text-white rounded-lg \r
            transition-all duration-200 text-sm font-medium`,children:[e.jsx(ie,{className:"w-4 h-4"}),"ä¿å­˜"]}),e.jsx("button",{onClick:l,className:`flex-1 px-3 py-2 bg-gray-800 hover:bg-gray-700 \r
            text-gray-300 rounded-lg transition-all duration-200 text-sm font-medium\r
            border border-gray-700`,children:"å–æ¶ˆ"})]})]})});q.displayName="ResultForm";const U=({onClose:s})=>{const r=m(c=>c.currentType),t=m(c=>c.selectedPoint),l=m(c=>c.results),n=m(c=>c.setCurrentType),a=m(c=>c.selectPoint),d=m(c=>c.setResult),o=m(c=>c.resetResults),x=m(c=>c.getPointStatus),b=m(c=>c.getPointResult),h=m(c=>c.getStats()),g=u.useMemo(()=>k[r]||[],[r]),p=u.useMemo(()=>h.total===0?0:Math.round(h.checked/h.total*100),[h]),j=u.useCallback(c=>{n(c)},[n]),y=u.useCallback(c=>{a(c)},[a]),f=u.useCallback((c,P,N)=>{d(c,P,N),a(null),s==null||s()},[d,a,s]),v=u.useCallback(()=>{a(null)},[a]),X=u.useCallback(()=>{window.confirm("ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ£€æµ‹ç»“æžœå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚")&&o()},[o]),D=u.useMemo(()=>t?g.find(c=>c.id===t):null,[t,g]),V=u.useMemo(()=>t?b(t):null,[t,b]);return e.jsxs("div",{className:"h-full bg-gray-900 rounded-xl border border-gray-800 shadow-xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex-none bg-gray-900/50 backdrop-blur-sm p-3 border-b border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4 text-blue-400"}),e.jsx("h2",{className:"text-sm font-bold text-gray-200",children:"æ£€æµ‹é¢æ¿"})]}),e.jsxs("button",{onClick:X,className:`flex items-center gap-1 px-2 py-1 text-xs text-gray-500 \r
              hover:text-red-400 hover:bg-red-500/10 rounded transition-all`,title:"é‡ç½®æ‰€æœ‰æ£€æµ‹ç»“æžœ",children:[e.jsx(ce,{className:"w-3 h-3"}),"é‡ç½®"]})]}),e.jsxs("div",{className:"flex gap-1 p-1 bg-gray-950 rounded-lg border border-gray-800",children:[e.jsxs("button",{onClick:()=>j("structure"),className:`
              flex-1 flex items-center justify-center gap-1.5 px-2 py-1.5 rounded-md text-xs font-medium transition-all
              ${r==="structure"?"bg-gray-800 text-blue-400 shadow-sm":"text-gray-500 hover:text-gray-300"}
            `,children:[e.jsx(de,{className:"w-3.5 h-3.5"}),"è½¦èº«ç»“æž„"]}),e.jsxs("button",{onClick:()=>j("paint"),className:`
              flex-1 flex items-center justify-center gap-1.5 px-2 py-1.5 rounded-md text-xs font-medium transition-all
              ${r==="paint"?"bg-gray-800 text-blue-400 shadow-sm":"text-gray-500 hover:text-gray-300"}
            `,children:[e.jsx(ue,{className:"w-3.5 h-3.5"}),"è½¦èº«æ¼†é¢"]})]})]}),e.jsxs("div",{className:"flex-none p-3 grid grid-cols-3 gap-2 border-b border-gray-800",children:[e.jsx(R,{label:"å·²æ£€æµ‹",value:h.checked,colorClass:"text-blue-400"}),e.jsx(R,{label:"æ­£å¸¸",value:h.normal,colorClass:"text-green-400"}),e.jsx(R,{label:"å¼‚å¸¸",value:h.warning+h.error,colorClass:"text-red-400"})]}),e.jsxs("div",{className:"flex-none px-3 py-2 border-b border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"æ£€æµ‹è¿›åº¦"}),e.jsxs("span",{className:"font-medium text-gray-300",children:[p,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-cyan-400 rounded-full transition-all duration-300",style:{width:`${p}%`}})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:D?e.jsx(q,{point:D,result:V,onSave:f,onCancel:v}):e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("h3",{className:"text-xs font-medium text-gray-500 mb-2 flex items-center justify-between",children:[e.jsx("span",{children:r==="structure"?"ç»“æž„æ£€æµ‹éƒ¨ä½":"æ¼†é¢æ£€æµ‹éƒ¨ä½"}),e.jsxs("span",{className:"text-gray-600",children:["(",g.length,")"]})]}),g.map(c=>{const P=x(c.id),N=l[c.id];return e.jsx(G,{point:c,status:P,isSelected:!1,onClick:()=>y(c.id),hasPaintData:!!(N!=null&&N.paintThickness),result:N},c.id)})]})})]})};class Se extends $.Component{constructor(t){super(t);I(this,"handleRefresh",()=>{window.location.reload()});this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,l){console.error("ErrorBoundary caught error:",t,l)}render(){var t;return this.state.hasError?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] bg-gray-900/50 rounded-xl p-8 text-center border border-gray-800",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mb-4 border border-red-500/20",children:e.jsx(xe,{className:"w-8 h-8 text-red-400"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-200 mb-2",children:"ç»„ä»¶åŠ è½½å‡ºé”™"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6 max-w-xs",children:((t=this.state.error)==null?void 0:t.message)||"æœªçŸ¥é”™è¯¯"}),e.jsxs("button",{onClick:this.handleRefresh,className:`flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-500 \r
              text-white rounded-xl transition-all duration-200 font-medium\r
              shadow-lg shadow-blue-600/20`,children:[e.jsx(ge,{className:"w-4 h-4"}),"åˆ·æ–°é¡µé¢"]})]}):this.props.children}}const H=()=>{const[s,r]=u.useState(!1),t=()=>{document.fullscreenElement?document.exitFullscreen().then(()=>{r(!1)}).catch(()=>{}):document.documentElement.requestFullscreen().then(()=>{r(!0)}).catch(()=>{})};return $.useEffect(()=>{const l=()=>{r(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",l),()=>document.removeEventListener("fullscreenchange",l)},[]),e.jsx("button",{onClick:t,className:"p-2 bg-gray-800/80 hover:bg-gray-700 rounded-lg transition-all duration-200 text-gray-400 hover:text-white border border-gray-700/50 active:scale-95",title:s?"é€€å‡ºå…¨å±":"å…¨å±æ˜¾ç¤º",children:s?e.jsx(he,{size:16}):e.jsx(be,{size:16})})},Ee=({compact:s=!1})=>{const r=u.useMemo(()=>[{status:i.NORMAL,icon:T,label:"æ­£å¸¸",color:"text-green-400",bgColor:"bg-green-400/10",borderColor:"border-green-400/20"},{status:i.WARNING,icon:O,label:"å¼‚å¸¸",color:"text-yellow-400",bgColor:"bg-yellow-400/10",borderColor:"border-yellow-400/20"},{status:i.ERROR,icon:E,label:"ä¸¥é‡",color:"text-red-400",bgColor:"bg-red-400/10",borderColor:"border-red-400/20"},{status:i.UNCHECKED,icon:S,label:"æœªæ£€",color:"text-gray-400",bgColor:"bg-gray-400/10",borderColor:"border-gray-400/20"}],[]);return s?e.jsx("div",{className:"flex items-center gap-1.5",children:r.map(t=>e.jsxs("div",{className:`flex items-center gap-1 px-1.5 py-1 rounded ${t.bgColor} border ${t.borderColor}`,children:[e.jsx(t.icon,{size:10,className:t.color}),e.jsx("span",{className:"text-[10px] font-medium text-gray-300",children:t.label})]},t.status))}):e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:r.map(t=>e.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-md ${t.bgColor} border ${t.borderColor}`,children:[e.jsx(t.icon,{size:12,className:t.color}),e.jsx("span",{className:"text-xs font-medium text-gray-300",children:t.label})]},t.status))})},F=({compact:s=!1})=>{const r=m(a=>a.results),t=u.useMemo(()=>{const a=Object.values(r),d=a.filter(b=>b!==i.UNCHECKED).length,o=a.includes(i.ERROR),x=a.includes(i.WARNING);return o?{message:s?"æœ‰é—®é¢˜":"æ£€æµ‹åˆ°ä¸¥é‡é—®é¢˜",color:"text-red-400",bg:"bg-red-400/10",border:"border-red-400/20",icon:E}:x?{message:s?"æœ‰å¼‚å¸¸":"æ£€æµ‹åˆ°éƒ¨åˆ†å¼‚å¸¸",color:"text-yellow-400",bg:"bg-yellow-400/10",border:"border-yellow-400/20",icon:O}:d>0?{message:s?"æ­£å¸¸":"è½¦è¾†æ£€æµ‹æ­£å¸¸",color:"text-green-400",bg:"bg-green-400/10",border:"border-green-400/20",icon:T}:{message:"ç­‰å¾…æ£€æµ‹",color:"text-gray-400",bg:"bg-gray-400/10",border:"border-gray-400/20",icon:S}},[r,s]),l=u.useMemo(()=>Object.values(r).filter(a=>a!==i.UNCHECKED).length,[r]),n=u.useMemo(()=>Object.keys(r).length,[r]);return e.jsxs("div",{className:`flex items-center gap-2 rounded-lg ${t.bg} border ${t.border} ${s?"px-2 py-1":"px-3 py-1.5"}`,children:[e.jsx(t.icon,{size:s?12:14,className:t.color}),e.jsx("span",{className:`font-medium ${t.color} ${s?"text-xs":"text-sm"}`,children:t.message}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",l,"/",n,")"]})]})},Oe=({isOpen:s,onClose:r,children:t})=>s?e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:"absolute right-0 top-0 bottom-0 w-[85vw] max-w-[400px] bg-gray-900 border-l border-gray-800 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-200",children:"æ£€æµ‹é¢æ¿"}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(z,{size:20,className:"text-gray-400"})})]}),e.jsx("div",{className:"p-4 h-[calc(100%-60px)] overflow-y-auto",children:t})]})]}):null,Te=()=>{const s=m(l=>l.selectPoint),[r,t]=u.useState(!1);return e.jsxs("div",{className:"h-screen bg-gray-950 text-white flex flex-col overflow-hidden",children:[e.jsxs("header",{className:"flex-none bg-gray-900/90 backdrop-blur-md border-b border-gray-800 px-3 py-2 lg:px-4 lg:py-3",children:[e.jsxs("div",{className:"hidden lg:flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent",children:"è½¦è¾†æ£€æµ‹å¯è§†åŒ–ç³»ç»Ÿ"}),e.jsx("p",{className:"text-xs text-gray-500",children:"äºŒæ‰‹è½¦äº‹æ•…æ£€æµ‹ Â· è½¦èº«ç»“æž„ Â· æ¼†é¢æ£€æµ‹"})]}),e.jsx("div",{className:"h-8 w-px bg-gray-800"}),e.jsx(F,{})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ee,{}),e.jsx(H,{})]})]}),e.jsxs("div",{className:"flex lg:hidden items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-base font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent",children:"è½¦è¾†æ£€æµ‹ç³»ç»Ÿ"}),e.jsx(F,{compact:!0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 hover:bg-blue-500 rounded-lg transition-colors text-sm font-medium",children:[e.jsx(me,{size:14}),"æ£€æµ‹é¢æ¿"]}),e.jsx(H,{})]})]})]}),e.jsx("main",{className:"flex-1 p-2 lg:p-4 overflow-hidden",children:e.jsxs("div",{className:"h-full flex flex-col lg:grid lg:grid-cols-12 gap-2 lg:gap-4",children:[e.jsx("div",{className:"flex-1 lg:col-span-8 min-h-0",children:e.jsxs("div",{className:"h-full bg-gray-900 rounded-xl border border-gray-800 shadow-xl overflow-hidden flex flex-col",children:[e.jsx("div",{className:"flex-1 relative min-h-0",children:e.jsx(Se,{children:e.jsx(Ce,{onPointClick:l=>{s(l),window.innerWidth<1024&&t(!0)}})})}),e.jsxs("div",{className:"flex-none px-3 py-2 lg:px-4 lg:py-2 bg-gray-950/80 border-t border-gray-800 flex items-center justify-center gap-3 lg:gap-6 text-[10px] lg:text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"hidden sm:inline",children:"ðŸ–±"}),e.jsx("span",{className:"sm:hidden",children:"ðŸ‘†"}),"æ‹–åŠ¨æ—‹è½¬"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"hidden sm:inline",children:"âš²"}),e.jsx("span",{className:"sm:hidden",children:"ðŸ¤"}),"ç¼©æ”¾"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"hidden sm:inline",children:"ðŸ‘†"}),e.jsx("span",{className:"sm:hidden",children:"ðŸ‘†"}),"ç‚¹å‡»æ ‡è®°"]})]})]})}),e.jsx("div",{className:"hidden lg:block lg:col-span-4 h-full min-h-0",children:e.jsx(U,{})})]})}),e.jsx(Oe,{isOpen:r,onClose:()=>t(!1),children:e.jsx(U,{onClose:()=>t(!1)})})]})};re.createRoot(document.getElementById("root")).render(e.jsx($.StrictMode,{children:e.jsx(Te,{})}));
